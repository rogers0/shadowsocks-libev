From: Roger Shimizu <rogershimizu@gmail.com>
Date: Wed, 25 May 2016 22:57:14 +0900
Subject: use system library: libcork libcorkipset libev libsodium libudns

autoreconf runs before configure, so it still doesn't have the condition
variable set yet.
Currently remove all system library part for configure.ac and Makefile.am
---
 Makefile.am     | 2 +-
 configure.ac    | 2 --
 src/Makefile.am | 8 ++------
 3 files changed, 3 insertions(+), 9 deletions(-)

diff --git a/Makefile.am b/Makefile.am
index 4a25c0f..68dd896 100644
--- a/Makefile.am
+++ b/Makefile.am
@@ -1,4 +1,4 @@
-SUBDIRS = libcork libipset src
+SUBDIRS = src
 
 if ENABLE_DOCUMENTATION
 SUBDIRS += doc
diff --git a/configure.ac b/configure.ac
index b91c297..132de4b 100755
--- a/configure.ac
+++ b/configure.ac
@@ -288,8 +288,6 @@ AM_COND_IF([ENABLE_DOCUMENTATION],
 
 AC_CONFIG_FILES([shadowsocks-libev.pc
                  Makefile
-                 libcork/Makefile
-                 libipset/Makefile
                  src/Makefile])
 
 AC_OUTPUT
diff --git a/src/Makefile.am b/src/Makefile.am
index 5f44848..2a954ca 100644
--- a/src/Makefile.am
+++ b/src/Makefile.am
@@ -2,14 +2,10 @@ VERSION_INFO = 2:0:0
 
 AM_CFLAGS = -g -O2 -Wall -Werror -Wno-deprecated-declarations -fno-strict-aliasing -std=gnu99 -D_GNU_SOURCE
 AM_CFLAGS += $(PTHREAD_CFLAGS)
-AM_CFLAGS += -I$(top_srcdir)/libipset/include
-AM_CFLAGS += -I$(top_srcdir)/libcork/include
 AM_CFLAGS += $(LIBPCRE_CFLAGS)
 
-SS_COMMON_LIBS = $(top_builddir)/libipset/libipset.la \
-                 $(top_builddir)/libcork/libcork.la \
-                 $(INET_NTOP_LIB) $(LIBPCRE_LIBS)
-SS_COMMON_LIBS += -lev -lsodium -lm
+SS_COMMON_LIBS = $(INET_NTOP_LIB) $(LIBPCRE_LIBS)
+SS_COMMON_LIBS += -lev -lsodium -lm -lcork -lcorkipset
 
 bin_PROGRAMS = ss-local ss-tunnel ss-server ss-manager
 
