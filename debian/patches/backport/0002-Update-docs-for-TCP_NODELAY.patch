From: Max Witten <pexcn97@gmail.com>
Date: Fri, 15 Sep 2017 10:47:02 +0800
Subject: Update docs for TCP_NODELAY

(cherry picked from commit b721c0fa6d1c8e6a8528c7808fd6c6f806c66578)
---
 doc/shadowsocks-libev.asciidoc | 3 +++
 doc/ss-local.asciidoc          | 6 +++++-
 doc/ss-redir.asciidoc          | 5 ++++-
 doc/ss-server.asciidoc         | 7 +++++--
 doc/ss-tunnel.asciidoc         | 5 ++++-
 src/utils.c                    | 2 ++
 6 files changed, 23 insertions(+), 5 deletions(-)

diff --git a/doc/shadowsocks-libev.asciidoc b/doc/shadowsocks-libev.asciidoc
index 3f3448d..78cd4d7 100644
--- a/doc/shadowsocks-libev.asciidoc
+++ b/doc/shadowsocks-libev.asciidoc
@@ -136,6 +136,9 @@ Enable port reuse.
 +
 Only available with Linux kernel > 3.9.0.
 
+--no-delay::
+Enable TCP_NODELAY.
+
 --acl <acl_config>::
 Enable ACL (Access Control List) and specify config file.
 +
diff --git a/doc/ss-local.asciidoc b/doc/ss-local.asciidoc
index f87f8a3..931fcd5 100644
--- a/doc/ss-local.asciidoc
+++ b/doc/ss-local.asciidoc
@@ -13,7 +13,8 @@ SYNOPSIS
  [-k <password>] [-m <encrypt_method>] [-f <pid_file>]
  [-t <timeout>] [-c <config_file>] [-i <interface>]
  [-a <user_name>] [-b <local_address>] [-n <nofile>]
- [--fast-open] [--reuse-port] [--acl <acl_config>] [--mtu <MTU>]
+ [--fast-open] [--reuse-port] [--acl <acl_config>]
+ [--mtu <MTU>] [--no-delay]
  [--plugin <plugin_name>] [--plugin-opts <plugin_options>]
  [--password <password>] [--key <key_in_base64>]
 
@@ -124,6 +125,9 @@ Enable Multipath TCP.
 +
 Only available with MPTCP enabled Linux kernel.
 
+--no-delay::
+Enable TCP_NODELAY.
+
 --plugin <plugin_name>::
 Enable SIP003 plugin. (Experimental)
 
diff --git a/doc/ss-redir.asciidoc b/doc/ss-redir.asciidoc
index 242349c..f9195b3 100644
--- a/doc/ss-redir.asciidoc
+++ b/doc/ss-redir.asciidoc
@@ -12,7 +12,7 @@ SYNOPSIS
  [-s <server_host>] [-p <server_port>] [-l <local_port>]
  [-k <password>] [-m <encrypt_method>] [-f <pid_file>]
  [-t <timeout>] [-c <config_file>] [-b <local_address>]
- [-a <user_name>] [-n <nofile>] [--mtu <MTU>]
+ [-a <user_name>] [-n <nofile>] [--mtu <MTU>] [--no-delay]
  [--plugin <plugin_name>] [--plugin-opts <plugin_options>]
  [--password <password>] [--key <key_in_base64>]
 
@@ -109,6 +109,9 @@ Enable port reuse.
 +
 Only available with Linux kernel > 3.9.0.
 
+--no-delay::
+Enable TCP_NODELAY.
+
 --plugin <plugin_name>::
 Enable SIP003 plugin. (Experimental)
 
diff --git a/doc/ss-server.asciidoc b/doc/ss-server.asciidoc
index 06fd36e..866f060 100644
--- a/doc/ss-server.asciidoc
+++ b/doc/ss-server.asciidoc
@@ -13,8 +13,8 @@ SYNOPSIS
  [-k <password>] [-m <encrypt_method>] [-f <pid_file>]
  [-t <timeout>] [-c <config_file>] [-i <interface>]
  [-a <user_name>] [-d <addr>] [-n <nofile>]
- [-b <local_address>] [--fast-open] [--reuse-port] [--mptcp]
- [--acl <acl_config>] [--mtu <MTU>]
+ [-b <local_address>] [--fast-open] [--reuse-port]
+ [--mptcp] [--acl <acl_config>] [--mtu <MTU>] [--no-delay]
  [--manager-address <path_to_unix_domain>]
  [--plugin <plugin_name>] [--plugin-opts <plugin_options>]
  [--password <password>] [--key <key_in_base64>]
@@ -113,6 +113,9 @@ Enable port reuse.
 +
 Only available with Linux kernel > 3.9.0.
 
+--no-delay::
+Enable TCP_NODELAY.
+
 --acl <acl_config>::
 Enable ACL (Access Control List) and specify config file.
 
diff --git a/doc/ss-tunnel.asciidoc b/doc/ss-tunnel.asciidoc
index e6d3667..b4b3e6e 100644
--- a/doc/ss-tunnel.asciidoc
+++ b/doc/ss-tunnel.asciidoc
@@ -13,7 +13,7 @@ SYNOPSIS
  [-k <password>] [-m <encrypt_method>] [-f <pid_file>]
  [-t <timeout>] [-c <config_file>] [-i <interface>]
  [-b <local_address>] [-a <user_name>] [-n <nofile>]
- [-L addr:port] [--mtu <MTU>] [--mptcp] [--reuse-port]
+ [-L addr:port] [--mtu <MTU>] [--mptcp] [--reuse-port] [--no-delay]
  [--plugin <plugin_name>] [--plugin-opts <plugin_options>]
  [--key <key_in_base64>]
 
@@ -121,6 +121,9 @@ Enable port reuse.
 +
 Only available with Linux kernel > 3.9.0.
 
+--no-delay::
+Enable TCP_NODELAY.
+
 --plugin <plugin_name>::
 Enable SIP003 plugin. (Experimental)
 
diff --git a/src/utils.c b/src/utils.c
index afa99e8..24c53f3 100644
--- a/src/utils.c
+++ b/src/utils.c
@@ -380,6 +380,8 @@ usage()
 #endif
 #ifndef MODULE_MANAGER
     printf(
+        "       [--no-delay]               Enable TCP_NODELAY.\n");
+    printf(
         "       [--key <key_in_base64>]    Key of your remote server.\n");
 #endif
     printf(
